<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="/backendData">
    <title>Schedule</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="sidebar">
        <div class="logo">
            <img src="/images/logo.png" alt="GoodOldDays Logo">
        </div>
        <ul class="menu">
            <li>
                <a href="/dashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </a>
            </li>

            <li id="Recommended schedule" class="active">
                <a href="/dashboard/RecommendedSchedule">
                    <i class="fas fa-calendar-alt"></i>
                    <span>Recommended Schedule</span>
                </a>
            </li>
            <li id="demandForecast">
                <a href="/dashboard/demandForecast">
                    <i class="fas fa-chart-line"></i>
                    <span>Demand Forecast</span>
                </a>
            </li>
            <li>
                <a href="/dashboard/employeeManagement">
                    <i class="fas fa-users-cog"></i>
                    <span>Employee Management</span>
                </a>
            </li>
            <li class="logout">
                <a href="/logout">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </a>
            </li>
        </ul>
    </div>

    <div class="main-content">
        <h1>Recommended Schedule</h1>
        <br>
        <h3>Choose Your Objective :</h3>
        <div class="schedule-container">
            <button class="tablink" onclick="openPage('Default', 'http://localhost:5000/getPredictedSchedule/default')">Default</button>
            <button class="tablink" onclick="openPage('Reduce Cost', 'http://localhost:5000/getPredictedSchedule/economic')">Reduce Cost</button>
            <button class="tablink" onclick="openPage('Good Service', 'http://localhost:5000/getPredictedSchedule/quality')">Good Service</button>

            <div id="Default" class="tabcontent">
                <br>
                <br>
                <div class="day1">
                    <h2>Day 1</h2>
                    <table class="timetable">
                        <thead>
                            <tr>
                                <th></th>
                                <th>10:00-14:00</th>
                                <th>14:00-18:00</th>
                                <th>18:00-22:00</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="day2">
                    <h2>Day 2</h2>
                    <table class="timetable">
                        <thead>
                            <tr>
                                <th></th>
                                <th>10:00-14:00</th>
                                <th>14:00-18:00</th>
                                <th>18:00-22:00</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="day3">
                    <h2>Day 3</h2>
                    <table class="timetable">
                        <thead>
                            <tr>
                                <th></th>
                                <th>10:00-14:00</th>
                                <th>14:00-18:00</th>
                                <th>18:00-22:00</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="day4">
                    <h2>Day 4</h2>
                    <table class="timetable">
                        <thead>
                            <tr>
                                <th></th>
                                <th>10:00-14:00</th>
                                <th>14:00-18:00</th>
                                <th>18:00-22:00</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="day5">
                    <h2>Day 5</h2>
                    <table class="timetable">
                        <thead>
                            <tr>
                                <th></th>
                                <th>10:00-14:00</th>
                                <th>14:00-18:00</th>
                                <th>18:00-22:00</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="day6">
                    <h2>Day 6</h2>
                    <table class="timetable">
                        <thead>
                            <tr>
                                <th></th>
                                <th>10:00-14:00</th>
                                <th>14:00-18:00</th>
                                <th>18:00-22:00</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="day7">
                    <h2>Day 7</h2>
                    <table class="timetable">
                        <thead>
                            <tr>
                                <th></th>
                                <th>10:00-14:00</th>
                                <th>14:00-18:00</th>
                                <th>18:00-22:00</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div> 
            </div>
            <div id="Reduce Cost" class="tabcontent">
                <br>
                <br>
                <div class="day1">
                    <h2>Day 1</h2>
                    <table class="timetable">
                        <thead>
                            <tr>
                                <th></th>
                                <th>10:00-14:00</th>
                                <th>14:00-18:00</th>
                                <th>18:00-22:00</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="day2">
                    <h2>Day 2</h2>
                    <table class="timetable">
                        <thead>
                            <tr>
                                <th></th>
                                <th>10:00-14:00</th>
                                <th>14:00-18:00</th>
                                <th>18:00-22:00</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="day3">
                    <h2>Day 3</h2>
                    <table class="timetable">
                        <thead>
                            <tr>
                                <th></th>
                                <th>10:00-14:00</th>
                                <th>14:00-18:00</th>
                                <th>18:00-22:00</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="day4">
                    <h2>Day 4</h2>
                    <table class="timetable">
                        <thead>
                            <tr>
                                <th></th>
                                <th>10:00-14:00</th>
                                <th>14:00-18:00</th>
                                <th>18:00-22:00</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="day5">
                    <h2>Day 5</h2>
                    <table class="timetable">
                        <thead>
                            <tr>
                                <th></th>
                                <th>10:00-14:00</th>
                                <th>14:00-18:00</th>
                                <th>18:00-22:00</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="day6">
                    <h2>Day 6</h2>
                    <table class="timetable">
                        <thead>
                            <tr>
                                <th></th>
                                <th>10:00-14:00</th>
                                <th>14:00-18:00</th>
                                <th>18:00-22:00</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="day7">
                    <h2>Day 7</h2>
                    <table class="timetable">
                        <thead>
                            <tr>
                                <th></th>
                                <th>10:00-14:00</th>
                                <th>14:00-18:00</th>
                                <th>18:00-22:00</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div> 
            </div>
            <div id="Good Service" class="tabcontent">
                <br>
                <br>
                <div class="day1">
                    <h2>Day 1</h2>
                    <table class="timetable">
                        <thead>
                            <tr>
                                <th></th>
                                <th>10:00-14:00</th>
                                <th>14:00-18:00</th>
                                <th>18:00-22:00</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="day2">
                    <h2>Day 2</h2>
                    <table class="timetable">
                        <thead>
                            <tr>
                                <th></th>
                                <th>10:00-14:00</th>
                                <th>14:00-18:00</th>
                                <th>18:00-22:00</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="day3">
                    <h2>Day 3</h2>
                    <table class="timetable">
                        <thead>
                            <tr>
                                <th></th>
                                <th>10:00-14:00</th>
                                <th>14:00-18:00</th>
                                <th>18:00-22:00</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="day4">
                    <h2>Day 4</h2>
                    <table class="timetable">
                        <thead>
                            <tr>
                                <th></th>
                                <th>10:00-14:00</th>
                                <th>14:00-18:00</th>
                                <th>18:00-22:00</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="day5">
                    <h2>Day 5</h2>
                    <table class="timetable">
                        <thead>
                            <tr>
                                <th></th>
                                <th>10:00-14:00</th>
                                <th>14:00-18:00</th>
                                <th>18:00-22:00</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="day6">
                    <h2>Day 6</h2>
                    <table class="timetable">
                        <thead>
                            <tr>
                                <th></th>
                                <th>10:00-14:00</th>
                                <th>14:00-18:00</th>
                                <th>18:00-22:00</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="day7">
                    <h2>Day 7</h2>
                    <table class="timetable">
                        <thead>
                            <tr>
                                <th></th>
                                <th>10:00-14:00</th>
                                <th>14:00-18:00</th>
                                <th>18:00-22:00</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div> 
            </div>
        </div>
    </div>
    <script>

        const input = [
  {
    "visit_date": "2023-01-01",
    "shift": "Afternoon",
    "visitors_count_by_shift": 18,
    "demand": 3,
    "day_of_week": 7,
    "flg_is_ph": 0
  },
  {
    "visit_date": "2023-01-01",
    "shift": "Evening",
    "visitors_count_by_shift": 244,
    "demand": 5,
    "day_of_week": 7,
    "flg_is_ph": 0
  },
  {
    "visit_date": "2023-01-01",
    "shift": "Morning",
    "visitors_count_by_shift": 145,
    "demand": 3,
    "day_of_week": 7,
    "flg_is_ph": 0
  },
  {
    "visit_date": "2023-01-02",
    "shift": "Afternoon",
    "visitors_count_by_shift": 13,
    "demand": 3,
    "day_of_week": 1,
    "flg_is_ph": 0
  },
  {
    "visit_date": "2023-01-02",
    "shift": "Evening",
    "visitors_count_by_shift": 164,
    "demand": 4,
    "day_of_week": 1,
    "flg_is_ph": 0
  },
  {
    "visit_date": "2023-01-02",
    "shift": "Morning",
    "visitors_count_by_shift": 97,
    "demand": 3,
    "day_of_week": 1,
    "flg_is_ph": 0
  },
  {
    "visit_date": "2023-01-03",
    "shift": "Afternoon",
    "visitors_count_by_shift": 8,
    "demand": 3,
    "day_of_week": 2,
    "flg_is_ph": 0
  },
  {
    "visit_date": "2023-01-03",
    "shift": "Evening",
    "visitors_count_by_shift": 94,
    "demand": 3,
    "day_of_week": 2,
    "flg_is_ph": 0
  },
  {
    "visit_date": "2023-01-03",
    "shift": "Morning",
    "visitors_count_by_shift": 56,
    "demand": 3,
    "day_of_week": 2,
    "flg_is_ph": 0
  },
  {
    "visit_date": "2023-01-04",
    "shift": "Afternoon",
    "visitors_count_by_shift": 5,
    "demand": 3,
    "day_of_week": 3,
    "flg_is_ph": 1
  },
  {
    "visit_date": "2023-01-04",
    "shift": "Evening",
    "visitors_count_by_shift": 70,
    "demand": 3,
    "day_of_week": 3,
    "flg_is_ph": 1
  },
  {
    "visit_date": "2023-01-04",
    "shift": "Morning",
    "visitors_count_by_shift": 42,
    "demand": 3,
    "day_of_week": 3,
    "flg_is_ph": 1
  },
  {
    "visit_date": "2023-01-05",
    "shift": "Afternoon",
    "visitors_count_by_shift": 5,
    "demand": 3,
    "day_of_week": 4,
    "flg_is_ph": 0
  },
  {
    "visit_date": "2023-01-05",
    "shift": "Evening",
    "visitors_count_by_shift": 65,
    "demand": 3,
    "day_of_week": 4,
    "flg_is_ph": 0
  },
  {
    "visit_date": "2023-01-05",
    "shift": "Morning",
    "visitors_count_by_shift": 39,
    "demand": 3,
    "day_of_week": 4,
    "flg_is_ph": 0
  },
  {
    "visit_date": "2023-01-06",
    "shift": "Afternoon",
    "visitors_count_by_shift": 6,
    "demand": 3,
    "day_of_week": 5,
    "flg_is_ph": 0
  },
  {
    "visit_date": "2023-01-06",
    "shift": "Evening",
    "visitors_count_by_shift": 84,
    "demand": 3,
    "day_of_week": 5,
    "flg_is_ph": 0
  },
  {
    "visit_date": "2023-01-06",
    "shift": "Morning",
    "visitors_count_by_shift": 49,
    "demand": 3,
    "day_of_week": 5,
    "flg_is_ph": 0
  },
  {
    "visit_date": "2023-01-07",
    "shift": "Afternoon",
    "visitors_count_by_shift": 16,
    "demand": 3,
    "day_of_week": 6,
    "flg_is_ph": 0
  },
  {
    "visit_date": "2023-01-07",
    "shift": "Evening",
    "visitors_count_by_shift": 204,
    "demand": 5,
    "day_of_week": 6,
    "flg_is_ph": 0
  },
  {
    "visit_date": "2023-01-07",
    "shift": "Morning",
    "visitors_count_by_shift": 122,
    "demand": 3,
    "day_of_week": 6,
    "flg_is_ph": 0
  }];

        function openPage(pageName, endpoint, element){
            var i, tabcontent;
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            document.getElementById(pageName).style.display='block';
            fetch(endpoint, {
                method: 'POST', headers:{'Content-Type': 'application/json'}, 
                body: JSON.stringify(input)}
            )
            .then(response => response.json())
            .then(data => {
                populateTimetable(data);
            })
        }

        function populateTimetable(data){
            const predictData = JSON.parse(data.predict);
            predictData.data.forEach((employee) => {
                const dayNumber = employee[0];
                const shift = employee[1];
                const staff = employee[2];
                const dayContainer = document.querySelector(`.day${dayNumber} .timetable tbody`);

                let existingRow = Array.from(dayContainer.querySelectorAll('tr')).find(row => row.querySelector('th').textContent === staff);

                if (existingRow){
                    existingRow.dataset.occupied = true;
                    const timeCells = existingRow.querySelectorAll('td');
                    const shiftIndex = {'morning':0, 'afternoon':1, 'evening':2}[shift.toLowerCase()];
                    if (shiftIndex !== undefined && timeCells.length > shiftIndex){
                        timeCells[shiftIndex].classList.add('occupied');
                    }
                }else{
                    let unoccupiedRow = dayContainer.querySelector('tr:not([data-occupied="true"])');
                    if (!unoccupiedRow){
                        unoccupiedRow = document.createElement('tr');
                        const newHeader = document.createElement('th');
                        newHeader.textContent = staff;
                        unoccupiedRow.appendChild(newHeader);
                        for (let i = 0; i < 3; i++) {
                            const newTd = document.createElement('td');
                            unoccupiedRow.appendChild(newTd);
                            const shiftIndex = {'morning':0, 'afternoon':1, 'evening':2}[shift.toLowerCase()];
                            if (i==shiftIndex){
                                newTd.classList.add('occupied');
                            }
                        }
                        dayContainer.appendChild(unoccupiedRow);
                    }
                    if (unoccupiedRow){
                        unoccupiedRow.dataset.occupied = true;
                        const employeeHeader = unoccupiedRow.querySelector('th');
                        if (employeeHeader){
                            employeeHeader.textContent = staff;
                        }
                        const timeCells = unoccupiedRow.querySelectorAll('td');
                        const shiftIndex = {'morning':0, 'afternoon':1, 'evening':2}[shift.toLowerCase()];
                        if (shiftIndex !== undefined && timeCells.length > shiftIndex){
                            timeCells[shiftIndex].classList.add('occupied');
                        }
                    }
                }
            });
        }
    </script>

</body>
</html>